### Documentação: Evento de Troca de Plano (SWITCH_PLAN) - Hotmart

A seguir estão os dados técnicos exatos e parâmetros enviados sempre que ocorre a troca de um plano de assinatura usando a Hotmart. Você recebe essas informações em JSON no seu endpoint de webhook.

#### Parâmetros e Descrições

| Parâmetro                              | Descrição                                                                                                                                                                                                                                                                                                                                       |
|----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **hottok** string                      | Cada conta possui um token único. Ele é a principal garantia de que a requisição está sendo feita pela Hotmart, o que é uma questão de segurança para evitar fraudes e ataques.<br>**Este campo será enviado com o nome `X-HOTMART-HOTTOK` no cabeçalho HTTP de todas as requisições e recomendamos validá-lo antes de tratar os dados recebidos.** <br>Se precisar trocar esta chave, entre em contato com nosso suporte. |
| **id** string                          | Código único de identificação do evento recebido.                                                                                                                                                                                                                                                                                                |
| **creation_date** long                 | Data de criação do evento. Essa data está em milissegundos, contando a partir de 1970-01-01 00:00:00 UTC.                                                                                                                                                                                                |
| **event** integer                      | Nome do evento recebido, que neste caso será `SWITCH_PLAN`.                                                                                                                                                                                                                                              |
| **version** integer                    | Versão do evento recebido. Essa versão é escolhida no momento de criação de uma configuração no Webhook. Neste caso o valor será sempre `2.0.0`.                                                                                                                                                        |
| **data** object                        | Dados relacionados ao evento de troca de plano.                                                                                                                                                                                                                                                          |
| **switch_plan_date** long              | Data da troca do plano. Ela está no formato **unix timestamp UTC**.                                                                                                                                                                                                                                      |
| subscription.product.**id** integer    | Identificador único do produto da assinatura.                                                                                                                                                                                                                                                            |
| subscription.product.**name** string   | Nome do produto de assinatura.                                                                                                                                                                                                                                                                           |
| subscription.**subscriber_code** string| Código do assinante. Este campo é usado pelo sistema externo para identificar um assinante de uma assinatura. Um mesmo comprador terá dois `subscriber_code` diferentes se ele assinar dois produtos diferentes.                                                    |
| subscription.**date_next_charge** long | Data da próxima cobrança em milissegundos a partir de 1970-01-01 00:00:00 UTC.                                                                                                                                                                                    |
| subscription.user.**email** string     | E-mail do assinante.                                                                                                                                                                                                                                                                                     |
| subscription.**status** string         | Mostra o status do momento em que aquela assinatura se encontra. Estes status podem ser: _ACTIVE, INACTIVE, CANCELED_BY_CUSTOMER, CANCELED_BY_VENDOR, CANCELED_BY_ADMIN, OVERDUE, STARTED, EXPIRED_.                                                             |
| plans.**id** long                      | Identificador único do plano de assinatura.                                                                                                                                                                                                                                                              |
| plans.**name** string                  | Nome do plano de assinatura atual.                                                                                                                                                                                                                                                                       |
| plans.offer.**key** string             | Código da oferta que gerou a assinatura do plano atual.                                                                                                                                                                                                           |
| plans.**current** boolean              | Indica se é o plano atual da assinatura. Um valor `true` significa que sim e `false` que não é o plano atual.                                                                                                                                                     |


#### Exemplo do payload recebido em uma troca de plano

```json
{
  "id": "93069d0e-f35b-443e-9146-75b552321a7e",
  "creation_date": 1633003064000,
  "event": "SWITCH_PLAN",
  "version": "2.0.0",
  "data": {
    "switch_plan_date": 1629926054000,
    "subscription": {
      "subscriber_code": "AT3IV3RX",
      "status": "ACTIVE",
      "date_next_charge": 1736337600000,
      "product": {
        "id": 4116023,
        "name": "Product Name"
      },
      "user": {
        "email": "email@hotmart.com"
      }
    },
    "plans": [
      {
        "id": 707635,
        "name": "Plan Test 1",
        "offer": {
          "key": "py01ycdp"
        },
        "current": true
      },
      {
        "id": 631288,
        "name": "Plan Test 2",
        "offer": {
          "key": "2nyk0xc3"
        },
        "current": false
      }
    ]
  }
}
```

**ATENÇÃO:**
- Valide sempre o cabeçalho `X-HOTMART-HOTTOK` para garantir autenticidade.
- NUNCA omita nem resuma listas, nem as opções dos status disponíveis citados acima.
- Estes campos e valores devem ser tratados exatamente como enviados no payload.
